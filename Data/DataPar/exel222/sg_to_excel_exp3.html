<html><head><!-- {********************************************************} -->
<!-- {                    Delphi World ©                      } -->
<!-- {             Выпуск 2002 - 2004                         } -->
<!-- {             Автор проекта:   ___Nikolay                } -->
<!-- {             E-mail: delphiworld@mail.ru                } -->
<!-- {             http://delphiworld.narod.ru                } -->
<!-- {********************************************************} -->



<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; 
charset=windows-1251">
<meta name="author" content="Delphi Sources (источник - 
http://www.delphiworld.narod.ru)">
<meta name="keywords" content="delphi, faq, anzeigen, class, colanzahl, 
content, contents, displayalerts, exportieren, function, image, images, 
language, pages, result, savefilename, schatzl, stringgrid, 
stringgridtoexcelsheet, tform, ubergeben, unassigned, vararraycreate, 
varvariant, xlapp, zellen, выпуск, интерфейс, программа, проекта">
<meta name="description" content="Delphi Sources - Программирование на 
Delphi: Исходники, программы, статьи, форум, FAQ">
<meta http-equiv="Expires" content="Mon, 01 Jan 2007 00:00:00 GMT">
<title>Экспортировать TStringGrid в Excel-файл 3 - Delphi Sources FAQ</title>
<link rel="stylesheet" href="sg_to_excel_exp3_files/css.css" 
type="text/css">
<link rel="shortcut icon" type="image/x-icon" 
href="http://www.delphisources.ru/images/favicon.ico">
<link rel="shortcut icon" type="image/x-icon" 
href="http://www.delphisources.ru/images/favicon.ico">

</head><body onload="resizeDiv(); resizeDiv_Left();" leftmargin="0" 
topmargin="0" rightmargin="0" bottommargin="0"><p style="margin-top: 
0pt; margin-bottom: 0pt;" align="center"><font color="#f7f7f7" 
face="Arial">
<link href="sg_to_excel_exp3_files/mystyle.css" type="text/css" 
rel="stylesheet">
<script language="JavaScript" type="text/JavaScript" src="sg_to_excel_exp3_files/res_div.js"></script>
<script language="JavaScript" type="text/JavaScript" src="sg_to_excel_exp3_files/res_div_left.js"></script>
</font></p><div class="window3" style="position: absolute; width: 110px;
 z-index: 1; right: 11px; top: 180px; background-color: rgb(216, 216, 
216);" id="right_panel" align="center">
<font color="#f7f7f7" face="Arial">				</font><p style="margin-top: 0pt;
 margin-bottom: 0pt;"><font color="#f7f7f7" face="Arial"><b><br>
				<a href="http://www.delphisources.ru/pages/donate_ru.html">Поддержка</a><font
 color="#000000"> / 
				</font>
				<a href="http://www.delphisources.ru/pages/donate_en.html">Donate</a><br>
&nbsp; </b></font></p>
<font color="#f7f7f7" face="Arial">				</font><div align="center">
<font color="#f7f7f7" face="Arial">					<table width="80%" border="0" 
cellpadding="4" cellspacing="0">
						<tbody><tr>
							<td align="center">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_webmoney.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="WebMoney" title="WebMoney" width="70" border="0" 
height="27"></a></td>
						</tr>
						<tr>
							<td align="center">
							<p style="margin-top: 0pt; margin-bottom: 0pt;">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_yan_money.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="Яндекс.Деньги" title="Яндекс.Деньги" width="70" 
border="0" height="28"></a></p></td>
						</tr>
						<tr>
							<td align="center">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_sms_kop.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="SMS.Копилка" title="SMS.Копилка" width="70" 
border="0" height="27"></a></td>
						</tr>
						<tr>
							<td align="center">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_money_mail.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="Деньги@Mail.ru" title="Деньги@Mail.ru" width="70" 
border="0" height="27"></a></td>
						</tr>
						<tr>
							<td align="center">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_rupay.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="Rupay" title="Rupay" width="70" border="0" 
height="28"></a></td>
						</tr>
						<tr>
							<td align="center">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_e_gold.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="E-gold" title="E-gold" width="70" border="0" 
height="33"></a></td>
						</tr>
						<tr>
							<td align="center">
							<a href="http://www.delphisources.ru/pages/donate_ru.html">
							<img src="sg_to_excel_exp3_files/logo_paypal.gif" 
onmouseover="className='window4'" onmouseout="className='window5'" 
class="window5" alt="PayPal" title="PayPal" width="70" border="0" 
height="27"></a></td>
						</tr>
					</tbody></table>
				</font></div>
<font color="#f7f7f7" face="Arial">				</font><p style="margin-top: 0pt;
 margin-bottom: 0pt;"><font color="#f7f7f7" face="Arial">&nbsp; </font></p>
<font color="#f7f7f7" face="Arial">				</font><p style="margin-top: 
0pt;"><font color="#f7f7f7" face="Arial"><font color="#000000">Благодарю
 за поддержку!</font></font></p><font color="#f7f7f7" face="Arial"><font
 color="#000000"></font>
				</font><div align="center"><font color="#f7f7f7" face="Arial">				
				<table width="80%" border="0" cellpadding="0" cellspacing="0">
					<tbody><tr>
						<td class="chat_wnd" height="52">
						<table style="width: 86%;" align="center" cellpadding="0" 
cellspacing="0">
							<tbody><tr>
								<td>
									<a target="_blank" 
href="http://www.delphisources.ru/pages/scripts/rss.xml">
									<img src="sg_to_excel_exp3_files/xml_rss.gif" alt="Лента RSS - 
Новости сайта" title="Лента RSS - Новости сайта" width="36" border="0" 
height="14"></a></td>
								<td>
									<img src="sg_to_excel_exp3_files/spacer.gif" width="10" 
border="0" height="1"></td>
									<td style="width: 100%;" align="right"><font color="#f7f7f7">
									<a target="_blank" 
href="http://www.delphisources.ru/pages/scripts/rss.xml">Новости сайта</a></font></td>
							</tr>
							<tr>
								<td>
<a target="_blank" 
href="http://www.delphisources.ru/forum/external_mod.php?type=RSS2">				
					<img src="sg_to_excel_exp3_files/xml_rss.gif" alt="Лента RSS - 
Новости форума" title="Лента RSS - Новости форума" width="36" border="0"
 height="14"></a></td>
								<td>
									<img src="sg_to_excel_exp3_files/spacer.gif" width="10" 
border="0" height="1"></td>
									<td style="width: 100%;" align="right"><font color="#f7f7f7">
<a target="_blank" 
href="http://www.delphisources.ru/forum/external_mod.php?type=RSS2">Новости
 форума</a></font></td>
							</tr>
						</tbody></table>

						</td>
					</tr>
				</tbody></table>
				</font></div><font color="#f7f7f7" face="Arial">				
				</font><p style="margin-top: 0pt; margin-bottom: 0pt;"><font 
color="#f7f7f7" face="Arial">&nbsp; 
				</font></p><div align="center"><font color="#f7f7f7" face="Arial">		
		
				<table width="80%" border="0" cellpadding="0" cellspacing="0">
					<tbody><tr>
						<td class="chat_wnd" height="32">
						<p align="center">
						<a href="http://www.delphisources.ru/pages/sources_list.html"><b>Архив
 исходников</b></a></p></td>
					</tr>
				</tbody></table>
				</font></div><font color="#f7f7f7" face="Arial">				
				</font><p style="margin-top: 0pt; margin-bottom: 0pt;"><font 
color="#f7f7f7" face="Arial"><b>&nbsp; </b>

				</font></p><div align="center"><font color="#f7f7f7" face="Arial">		
		
				<table width="80%" border="0" cellpadding="0" cellspacing="0">
					<tbody><tr>
						<td class="chat_wnd" style="height: 32px;">
						<p class="style3" align="center"><font color="#000000"><span 
class="style1">
						<strong><br>
						Automatic translation</strong></span></font><br>
&nbsp; 
						<table style="width: 78px;" align="center">
							<tbody><tr>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/eng/eng_lan.html">
								<img alt="English" title="English" 
src="sg_to_excel_exp3_files/fl_eng.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/den/den_lan.html">
								<img alt="German" title="German" 
src="sg_to_excel_exp3_files/fl_den.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/fre/fre_lan.html">
								<img alt="French" title="French" 
src="sg_to_excel_exp3_files/fl_fre.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
							</tr>
							<tr>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/ita/ita_lan.html">
								<img alt="Italian" title="Italian" 
src="sg_to_excel_exp3_files/fl_ita.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/spa/spa_lan.html">
								<img alt="Spanish" title="Spanish" 
src="sg_to_excel_exp3_files/fl_spa.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/por/por_lan.html">
								<img alt="Portuguese" title="Portuguese" 
src="sg_to_excel_exp3_files/fl_por.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
							</tr>
							<tr>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/gre/gre_lan.html">
								<img alt="Greece" title="Greece" 
src="sg_to_excel_exp3_files/fl_gre.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/jap/jap_lan.html">
								<img alt="Japan" title="Japan" 
src="sg_to_excel_exp3_files/fl_jap.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/chi/chi_lan.html">
								<img alt="Chinese" title="Chinese" 
src="sg_to_excel_exp3_files/fl_chi.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
							</tr>
							<tr>
								<td class="style2" style="width: 26px; height: 16px;">
								&nbsp;</td>
								<td class="style2" style="width: 26px; height: 16px;">
								<a 
href="http://www.delphisources.ru/pages/scripts/translate/kor/kor_lan.html">
								<img alt="Korean" title="Korean" 
src="sg_to_excel_exp3_files/fl_kor.gif" 
onmouseover="className='window4'" onmouseout="className='window6'" 
class="window6" width="18" height="12"></a></td>
								<td class="style2" style="width: 26px; height: 16px;">
								&nbsp;</td>
							</tr>
						</tbody></table>
						</p><p class="style3" align="center">&nbsp;&nbsp;</p></td>
					</tr>
				</tbody></table>
				</font></div><font color="#f7f7f7" face="Arial">				
				</font><p class="style3"><font color="#f7f7f7" face="Arial"><b>&nbsp;
 </b></font></p></div>

<font color="#f7f7f7" face="Arial">		

</font><div align="center">
<div style="position: absolute; width: 120px; z-index: 1; left: 5px; 
top: 180px;" id="left_panel">
<p style="margin-top: 0pt; margin-bottom: 0pt;">
<script type="text/javascript"><!--
google_ad_client = "pub-8454776797423008";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
//2007-01-20: left_ad_site
google_ad_channel = "5896660433";
google_color_border = "f5f5f5";
google_color_bg = "f5f5f5";
google_color_link = "292a6d";
google_color_text = "000000";
google_color_url = "008000";
//--></script>
<script type="text/javascript" src="sg_to_excel_exp3_files/show_ads.js">
</script><script src="sg_to_excel_exp3_files/expansion_embed.js"></script><script src="sg_to_excel_exp3_files/test_domain.js"></script><script>google_protectAndRun("ads_core.google_render_ad", google_handleError, google_render_ad);</script><font
 color="#f7f7f7" face="Arial"><ins style="display: inline-table; border:
 medium none; height: 600px; margin: 0pt; padding: 0pt; position: 
relative; visibility: visible; width: 120px;"><ins style="display: 
block; border: medium none; height: 600px; margin: 0pt; padding: 0pt; 
position: relative; visibility: visible; width: 120px;"><iframe 
allowtransparency="true" hspace="0" id="google_ads_frame1" 
marginheight="0" marginwidth="0" name="google_ads_frame" 
src="sg_to_excel_exp3_files/ads.htm" style="left: 0pt; position: 
absolute; top: 0pt;" vspace="0" width="120" frameborder="0" height="600"
 scrolling="no"></iframe></ins></ins>			
</font></p></div>
</div>
<div id="dummy" style="position: absolute; height: 1in;"></div>
<!--
<p align='center' style='margin-top: 0; margin-bottom: 0'>&nbsp; -->
<!-- Google Begin -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="sg_to_excel_exp3_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1830240-1");
pageTracker._trackPageview();
</script>
<!-- Google End --><font color="#f7f7f7" face="Arial"></font><p></p>
 
<p style="margin-top: 0pt;" align="center"><font color="#f7f7f7" 
face="Arial"></font></p><table class="whitetable" width="100%" 
cellpadding="0" cellspacing="0">
  <tbody><tr height="160">
    <td width="100%" background="sg_to_excel_exp3_files/bg_title.jpg"><p
 style="text-align: left; margin-top: 0pt; margin-bottom: 0pt;">
[ <a href="http://www.delphisources.ru/">Вернуться на главную страницу 
сайта "Delphi Sources"</a> ]
</p><p style="text-align: center; margin-top: 0pt; margin-bottom: 0pt;">
<br>
<b><font size="2">Delphi</font><font size="2"> FAQ - Часто задаваемые 
вопросы</font></b>
<font size="2"><br></font><br>
| <a href="http://www.delphisources.ru/pages/faq/data_bases.html">Базы 
данных</a> | 
<a href="http://www.delphisources.ru/pages/faq/graph_games.html">Графика
 и Игры</a> | 
<a href="http://www.delphisources.ru/pages/faq/internet_net.html">Интернет
 и Сети</a> | 
<a href="http://www.delphisources.ru/pages/faq/components_classes.html">Компоненты
 и Классы</a> | 
<a href="http://www.delphisources.ru/pages/faq/multimedia.html">Мультимедиа</a>
 |<br>| 
<a href="http://www.delphisources.ru/pages/faq/os_hardware.html">ОС и 
Железо</a> | 
<a href="http://www.delphisources.ru/pages/faq/program_interface.html">Программа
 и Интерфейс</a> | 
<a href="http://www.delphisources.ru/pages/faq/desktop.html">Рабочий 
стол</a> | 
<a href="http://www.delphisources.ru/pages/faq/sintaxis.html">Синтаксис</a>
 | 
<a href="http://www.delphisources.ru/pages/faq/technologies.html">Технологии</a>
 | 
<a href="http://www.delphisources.ru/pages/faq/file_system.html">Файловая
 система</a> |
</p><p style="text-align: center; margin-top: 6px; margin-bottom: 0pt;">
Материалы предоставлены сайтом 
<a target="_blank" href="http://www.delphiworld.narod.ru/">Delphi World</a>
  </p></td></tr>
  <tr height="50">
    <td width="100%">
      <table class="article" style="width: 740px;" width="90%" 
align="center" cellpadding="0" cellspacing="10">
        <tbody><tr>
          <td width="90%">

<p style="margin-top: 0pt;" align="center"></p><div align="center">
<!-- SiteSearch Google -->
<form method="get" action="http://www.google.ru/custom" 
target="google_window">
<table bgcolor="#f5f5f5" border="0">
<tbody><tr><td valign="top" align="left" height="32" nowrap="nowrap">
<a href="http://www.google.com/">
<img src="sg_to_excel_exp3_files/Logo_25wht.gif" alt="Google" 
align="middle" border="0"></a>
</td>
<td nowrap="nowrap">
<input name="domains" value="www.delphisources.ru" type="hidden">
<label for="sbi" style="display: none;">Введите условия поиска</label>
<input name="q" size="31" maxlength="255" id="sbi" type="text">
<label for="sbb" style="display: none;">Отправить форму поиска</label>
<input name="sa" value="Поиск" id="sbb" type="submit">
</td></tr>
<tr>
<td>&nbsp;</td>
<td nowrap="nowrap">
<table>
<tbody><tr>
<td>
<input name="sitesearch" value="" checked="checked" id="ss0" 
type="radio">
<label for="ss0" title="Искать в Интернете"><font color="#000000" 
size="-1">Web</font></label></td>
<td>
<input name="sitesearch" value="www.delphisources.ru" id="ss1" 
type="radio">
<label for="ss1" title="Поиск www.delphisources.ru"><font 
color="#000000" size="-1">www.delphisources.ru</font></label></td>
</tr>
</tbody></table>
<input name="client" value="pub-8454776797423008" type="hidden">
<input name="forid" value="1" type="hidden">
<input name="channel" value="5982974080" type="hidden">
<input name="ie" value="windows-1251" type="hidden">
<input name="oe" value="windows-1251" type="hidden">
<input name="cof" 
value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:f5f5f5;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:19;LW:98;L:http://www.delphisources.ru/images/fon/baner_mini.gif;S:http://www.delphisources.ru;FORID:1"
 type="hidden">
<input name="hl" value="ru" type="hidden">
</td></tr></tbody></table>
</form>
<!-- SiteSearch Google -->
</div><p></p>
<b>Экспортировать TStringGrid в Excel-файл 3</b>

<hr><br>

<p align="right">
Оформил: <a target="_blank" href="mailto:DeeCo@mail.ru">DeeCo</a><br>
Автор: <a target="_blank" href="http://www.swissdelphicenter.ch/">http://www.swissdelphicenter.ch</a>
</p>
<pre> <font color="#000080"><i>{ Code by Reinhard Schatzl }</i></font>

 <b>uses</b>
   ComObj;

 <font color="#000080"><i>// Hilfsfunktion fur StringGridToExcelSheet </i></font>
<font color="#000080"><i>// Helper function for StringGridToExcelSheet </i></font>
<b>function</b> RefToCell(RowID, ColID: Integer): <b>string</b>;
 <b>var</b>
   ACount, APos: Integer;
 <b>begin</b>
   ACount := ColID <b>div</b> 26;
   APos := ColID <b>mod</b> 26;
   <b>if</b> APos = 0 <b>then</b>
   <b>begin</b>
     ACount := ACount - 1;
     APos := 26;
   <b>end</b>;

   <b>if</b> ACount = 0 <b>then</b>
     Result := Chr(Ord('A') + ColID - 1) + IntToStr(RowID);

   <b>if</b> ACount = 1 <b>then</b>
     Result := 'A' + Chr(Ord('A') + APos - 1) + IntToStr(RowID);

   <b>if</b> ACount &gt; 1 <b>then</b>
     Result := Chr(Ord('A') + ACount - 1) + Chr(Ord('A') + APos - 1) + IntToStr(RowID);
 <b>end</b>;

 <font color="#000080"><i>// StringGrid Inhalt in Excel exportieren </i></font>
<font color="#000080"><i>// Export StringGrid contents to Excel </i></font>
<b>function</b> StringGridToExcelSheet(Grid: TStringGrid; SheetName, FileName: <b>string</b>;
   ShowExcel: Boolean): Boolean;
 <b>const</b>
   xlWBATWorksheet = -4167;
 <b>var</b>
   SheetCount, SheetColCount, SheetRowCount, BookCount: Integer;
   XLApp, Sheet, Data: OLEVariant;
   I, J, N, M: Integer;
   SaveFileName: <b>string</b>;
 <b>begin</b>
   <font color="#000080"><i>//notwendige Sheetanzahl feststellen </i></font>
  SheetCount := (Grid.ColCount <b>div</b> 256) + 1;
   <b>if</b> Grid.ColCount <b>mod</b> 256 = 0 <b>then</b>
     SheetCount := SheetCount - 1;
   <font color="#000080"><i>//notwendige Bookanzahl feststellen </i></font>
  BookCount := (Grid.RowCount <b>div</b> 65536) + 1;
   <b>if</b> Grid.RowCount <b>mod</b> 65536 = 0 <b>then</b>
     BookCount := BookCount - 1;

   <font color="#000080"><i>//Create Excel-OLE Object </i></font>
  Result := False;
   XLApp  := CreateOleObject('Excel.Application');
   <b>try</b>
     <font color="#000080"><i>//Excelsheet anzeigen </i></font>
    <b>if</b> ShowExcel = False <b>then</b>
       XLApp.Visible := False
     <b>else</b>
       XLApp.Visible := True;
     <font color="#000080"><i>//Workbook hinzufugen </i></font>
    <b>for</b> M := 1 <b>to</b> BookCount <b>do</b>
     <b>begin</b>
       XLApp.Workbooks.Add(xlWBATWorksheet);
       <font color="#000080"><i>//Sheets anlegen </i></font>
      <b>for</b> N := 1 <b>to</b> SheetCount - 1 <b>do</b>
       <b>begin</b>
         XLApp.Worksheets.Add;
       <b>end</b>;
     <b>end</b>;
     <font color="#000080"><i>//Sheet ColAnzahl feststellen </i></font>
    <b>if</b> Grid.ColCount &lt;= 256 <b>then</b>
       SheetColCount := Grid.ColCount
     <b>else</b>
       SheetColCount := 256;
     <font color="#000080"><i>//Sheet RowAnzahl feststellen </i></font>
    <b>if</b> Grid.RowCount &lt;= 65536 <b>then</b>
       SheetRowCount := Grid.RowCount
     <b>else</b>
       SheetRowCount := 65536;

     <font color="#000080"><i>//Sheets befullen </i></font>
    <b>for</b> M := 1 <b>to</b> BookCount <b>do</b>
     <b>begin</b>
       <b>for</b> N := 1 <b>to</b> SheetCount <b>do</b>
       <b>begin</b>
         <font color="#000080"><i>//Daten aus Grid holen </i></font>
        Data := VarArrayCreate([1, Grid.RowCount, 1, SheetColCount], varVariant);
         <b>for</b> I := 0 <b>to</b> SheetColCount - 1 <b>do</b>
           <b>for</b> J := 0 <b>to</b> SheetRowCount - 1 <b>do</b>
             <b>if</b> ((I + 256 * (N - 1)) &lt;= Grid.ColCount) <b>and</b>
               ((J + 65536 * (M - 1)) &lt;= Grid.RowCount) <b>then</b>
               Data[J + 1, I + 1] := Grid.Cells[I + 256 * (N - 1), J + 65536 * (M - 1)];
         <font color="#000080"><i>//------------------------- </i></font>
        XLApp.Worksheets[N].Select;
         XLApp.Workbooks[M].Worksheets[N].Name := SheetName + IntToStr(N);
         <font color="#000080"><i>//Zellen als String Formatieren </i></font>
        XLApp.Workbooks[M].Worksheets[N].Range[RefToCell(1, 1),
           RefToCell(SheetRowCount, SheetColCount)].Select;
         XLApp.Selection.NumberFormat := '@';
         XLApp.Workbooks[M].Worksheets[N].Range['A1'].Select;
         <font color="#000080"><i>//Daten dem Excelsheet ubergeben </i></font>
        Sheet := XLApp.Workbooks[M].WorkSheets[N];
         Sheet.Range[RefToCell(1, 1), RefToCell(SheetRowCount, SheetColCount)].Value :=
           Data;
       <b>end</b>;
     <b>end</b>;
     <font color="#000080"><i>//Save Excel Worksheet </i></font>
    <b>try</b>
       <b>for</b> M := 1 <b>to</b> BookCount <b>do</b>
       <b>begin</b>
         SaveFileName := Copy(FileName, 1,Pos('.', FileName) - 1) + IntToStr(M) +
           Copy(FileName, Pos('.', FileName),
           Length(FileName) - Pos('.', FileName) + 1);
         XLApp.Workbooks[M].SaveAs(SaveFileName);
       <b>end</b>;
       Result := True;
     <b>except</b>
       <font color="#000080"><i>// Error ? </i></font>
    <b>end</b>;
   <b>finally</b>
     <font color="#000080"><i>//Excel Beenden </i></font>
    <b>if</b> (<b>not</b> VarIsEmpty(XLApp)) <b>and</b> (ShowExcel = False) <b>then</b>
     <b>begin</b>
       XLApp.DisplayAlerts := False;
       XLApp.Quit;
       XLAPP := Unassigned;
       Sheet := Unassigned;
     <b>end</b>;
   <b>end</b>;
 <b>end</b>;

 <font color="#000080"><i>//Example </i></font>
<b>procedure</b> TForm1.Button1Click(Sender: TObject);
 <b>begin</b>
   <font color="#000080"><i>//StringGrid inhalt in Excel exportieren </i></font>
  <font color="#000080"><i>//Grid : stringGrid, SheetName : stringgrid Print, Pfad : c:\Test\ExcelFile.xls, Excelsheet anzeigen </i></font>
  StringGridToExcelSheet(StringGrid, 'Stringgrid Print', 'c:\Test\ExcelFile.xls', True);
 <b>end</b>;</pre>
<!-- end -->
          </td>
        </tr>
      </tbody></table>
    </td>
  </tr>
<tr height="11">
    <td width="100%" background="sg_to_excel_exp3_files/bottom_line.jpg"></td>
  </tr>
<tr>    
<td width="100%" align="center">
<br>
Источник - <a target="_blank" href="http://delphiworld.narod.ru/" 
title="Перейти на сайт проекта">Проект "Delphi World"</a>
 © Выпуск 2002 - 2004 <br>
Автор проекта: <a href="mailto:delphiworld@mail.ru" title="Отправить 
статью или интересную работу">Акулов Николай</a>
<br><br>
<a href="http://www.megaindex.ru/?from=137">
<img alt="MegaIndex - Уникальный инструмент SEO-анализа" 
title="MegaIndex - Уникальный инструмент SEO-анализа" 
src="sg_to_excel_exp3_files/megaindex.jpg" width="468" border="0" 
height="60"></a>
<br>
<br><noindex>
<!-- SpyLOG -->
<script src="sg_to_excel_exp3_files/counter2.js" type="text/javascript" id="spylog_code" counter="652593"></script><script language="javascript">window.spylog_js=1;</script><script language="javascript1.1">window.spylog_js=1.1;</script><script language="javascript1.2">window.spylog_js=1.2;</script><script language="javascript1.3">window.spylog_js=1.3;</script><script language="javascript1.4">window.spylog_js=1.4;</script><script language="javascript1.5">window.spylog_js=1.5;</script><script language="javascript1.6">window.spylog_js=1.6;</script><script language="javascript1.7">window.spylog_js=1.7;</script><script language="javascript1.8">window.spylog_js=1.8;</script><script language="javascript1.9">window.spylog_js=1.9;</script><script language="javascript"></script><a
 
href="http://u6525.93.spylog.com/cnt?cid=652593&amp;c=1&amp;fr=1&amp;fl=10.0&amp;px=24&amp;sl=1.8&amp;wh=1024x768&amp;j=N&amp;t=-180&amp;pg=http%3A//www.delphisources.ru/pages/faq/base/sg_to_excel_exp3.html&amp;r=http%3A//www.delphisources.ru/pages/faq/all_articles.html&amp;title=%u042D%u043A%u0441%u043F%u043E%u0440%u0442%u0438%u0440%u043E%u0432%u0430%u0442%u044C%20TStringGrid%20%u0432%20Excel-%u0444%u0430%u0439%u043B%203%20-%20Delphi%20Sources%20FAQ&amp;rn=0.6969713425666823&amp;f=3"
 target="_blank"><img src="sg_to_excel_exp3_files/cnt.gif" alt="SpyLOG" 
border="0"></a>
<noscript>
<a href="http://u6525.93.spylog.com/cnt?cid=652593&f=3&p=0" target="_blank">
<img src="http://u6525.93.spylog.com/cnt?cid=652593&p=0" alt='SpyLOG' border='0' width=88 height=31 ></a> 
</noscript>
<!--/ SpyLOG -->

&nbsp;&nbsp;

<!--begin of Rambler's Top100 code -->
<a href="http://top100.rambler.ru/top100/">
<img src="sg_to_excel_exp3_files/top100.gif" alt="" width="1" border="0"
 height="1"></a>
<!--end of Top100 code-->
<!--begin of Top100 logo--><a 
href="http://top100.rambler.ru/home?id=720368">
<img src="sg_to_excel_exp3_files/banner-88x31-rambler-darkblue2.gif" 
alt="Rambler's Top100" width="88" border="0" height="31"></a>
<!--end of Top100 logo -->

&nbsp;&nbsp;&nbsp;

<!--Rating@Mail.ru COUNTER--><script language="JavaScript" type="text/javascript"><!--
d=document;var a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1" type="text/javascript"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2" type="text/javascript"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3" type="text/javascript"><!--
js=13//--></script><script language="JavaScript" type="text/javascript"><!--
d.write('<a href="http://top.mail.ru/jump?from=916783"'+
' target=_top><img src="http://top.list.ru/counter'+
'?id=916783;t=56;js='+js+a+';rand='+Math.random()+
'" alt="Рейтинг@Mail.ru"'+' border=0 height=31 width=88/><\/a>')
if(11<js)d.write('<'+'!-- ')//--></script><a 
href="http://top.mail.ru/jump?from=916783" target="_top"><img 
src="sg_to_excel_exp3_files/counter.gif" alt="Рейтинг@Mail.ru" 
width="88/" border="0" height="31"></a><!-- <noscript><a
target=_top href="http://top.mail.ru/jump?from=916783"><img
src="http://top.list.ru/counter?js=na;id=916783;t=56"
border=0 height=31 width=88
alt="Рейтинг@Mail.ru"/></a></noscript><script language="JavaScript" type="text/javascript"><!--
if(11<js)d.write('--'+'>')//-->
<!--/COUNTER-->



<font color="#f7f7f7">
&nbsp;&nbsp;&nbsp; 
<!--LiveInternet counter-->
<script language="JavaScript"><!--
document.write('<a href="http://www.liveinternet.ru/click" '+
'target=_blank><img src="http://counter.yadro.ru/hit?t54.6;r'+
escape(document.referrer)+((typeof(screen)=='undefined')?'':
';s'+screen.width+'*'+screen.height+'*'+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+';u'+escape(document.URL)+
';i'+escape('Жж'+document.title.substring(0,80))+';'+Math.random()+
'" title="liveinternet.ru: показано число просмотров и посетителей за 24 часа" '+
'border=0 width=88 height=31></a>')//--></script><a 
href="http://www.liveinternet.ru/click" target="_blank"><img 
src="sg_to_excel_exp3_files/hit.gif" title="liveinternet.ru: показано 
число просмотров и посетителей за 24 часа" width="88" border="0" 
height="31"></a>
<!--/LiveInternet-->
&nbsp;&nbsp;&nbsp;
<a href="http://www.yandex.ru/cy?base=0&amp;host=www.delphisources.ru">
<img src="sg_to_excel_exp3_files/cycounter.gif" alt="Яндекс цитирования"
 width="88" border="0" height="31"></a>
</font>&nbsp;
</noindex></td> 
</tr>
</tbody></table>
<br> 
 
</body></html>